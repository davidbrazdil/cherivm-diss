% Change default axes fonts.
set(0,'DefaultAxesFontName', 'Arial')
set(0,'DefaultAxesFontSize', 14)

% Change default text fonts.
set(0,'DefaultTextFontname', 'Arial')
set(0,'DefaultTextFontSize', 14)

% Change default plot line colours
set(0,'DefaultAxesColorOrder',[0 153 153; 0 204 0; 255 0 0; 255 116 0] ./ 255);

% MICROBENCHMARKS

data = [ 78.94  5.50  78.45  5.21  229.3   27.9  
          2.665 0.955  2.341 0.829   4.182  0.745
          2.040 0.146  2.045 0.079   2.044  0.080
          2.016 0.030  2.020 0.027   2.007  0.023
          1.999 0.026  2.017 0.029   2.005  0.009 ];

Y =    [ (data(:,1)./data(:,1)) (data(:,3)./data(:,1)) (data(:,5)./data(:,1)) ];
       
errY = [ (data(:,2)./data(:,1)) (data(:,4)./data(:,1)) (data(:,6)./data(:,1)) ];

xlab = { 'getPublicKeySize'
         'initIDs'
         'generateKeys' 
         'encryptData'
         'decryptData'
       };

ylab = 'normalised running time';

lege = { 'JamVM (direct buffers)' 'JamVM (array buffers)' 'Qishr' };

hfig = figure;
set(hfig, 'Position', [0 0 1024 576]);
colormap('summer');
handle = barwitherr(errY, Y);
grid on
set(gca, 'XTickLabel', xlab, 'XTick', 1:numel(xlab))
ylabel(ylab);
legend(handle, lege);

% add a horizontal line at 100%
hold on
xlim = get(gca, 'xlim');
plot(xlim, [1 1])


% ACCESS CONTROL OVERHEAD

data1=       [ 1410481.3     424236.32
1114138.6     286276.03
1406415.1     462650.37
1320612.8     369251.74
1326079.3     378359.94
1348473.7        399127 ];
data2 =      [   2531886     690857.32
2231398.1     595630.55
2516387.4     717025.27
2479752.6     648697.21
2460003.6     681044.19
2513757.6     656390.69 ];
data3 =      [ 2791131.8     705229.34
2964179.6     679478.89
3506314.1     697521.17
3606836.4     683634.19
3820618.7      676469.7
4033441.6     628581.24 ];

Y = [ data1(:,1)     (data2(:,1)-data1(:,1))       (data3(:,1)-data2(:,1)) ] .* (10^(-6));
errY = [ data1(:,2) data2(:,2) data3(:,2) ] .* (10^(-6));
absY = [ data1(:,1) data2(:,1) data3(:,1) ] .* (10^(-6));
           
yrange = [6:-1:1];
ylims = [0 5];
       
xlab = { 'null'
         'always allow'
         '1 comparison' 
         '4 comparisons' 
         '8 comparisons' 
         '16 comparisons' 
       };

ylab = 'invocation time / ms';

lege = { 'Unsandboxed' 'Access control disabled' 'Access control enabled' };

hfig = figure;
set(hfig, 'Position', [0 0 1024 576]);
colormap('summer');
handle = hbarwitherr(errY, absY, absY);
grid on
set(gca, 'XTickLabel', xlab, 'XTick', 1:numel(xlab))
rotateXLabels(gca,0); 
ylabel(ylab);
legend(handle, lege);

% MATRIX SQUARING

Y = [    12573600   19999590    89583520
         31470750   23040920   103769760
         98105560   35092020   131222840
        223445990   41620980   161358930
        426942360   75217960   235046250
    ] .* (10^(-9));

lege = { 'JamVM Java' 'JamVM JNI' 'Qishr JNI' };

xlab = 'matrix size';
ylab = 'time to square / s';

xrange = 1:5;
ylims = [0 0.3];

hfig = figure;
set(hfig, 'Position', [0 0 1024 576]);
% errorbar(Y, errY);
handle = plot(xrange, Y, '-s', 'LineWidth',2);
colormap('summer');
legend(handle, lege);
xlabel(xlab);
ylabel(ylab);
grid on;
ylim(ylims);


Y = [    15166990	19999590	89583520
35146280	23040920	103769760
95843100	35092020	131222840
241684050	41620980	161358930
438218170	75217960	235046250
745042950	113915650	326598270
1115822860	157863730	444756020
1961589290	230473620	633423460
2598817430	333173900	803589990
3743307710	480370910	1079633400
4998759430	553332300	1464536660
6564814092	730140890	1801784243
8398446341	990856710	2361305890
10343707675	1199466450	2912003655
12901486340	1504772020	3597323150
15131459570	1981398899	4251831490
18599465280	2285472840	5147065630
21725832950	2726291510	6144054980
25417560768	3221344880	7250951750
30075594703	3766032690	8331240727 ] .* (10^(-9));

xrange = 1:20;

hfig = figure;
set(hfig, 'Position', [0 0 1024 576]);
colormap('summer');
% errorbar(Y, errY);
handle = plot(xrange, Y, '-s', 'LineWidth',2);
colormap('summer');
legend(handle, lege);
xlabel(xlab);
ylabel(ylab);
grid on;



% MATRIX SQUARING - OVERHEAD COMPARISON

Y =     [ 347.93
          350.37
          273.94
          287.69
          212.49
          186.70
          181.73
          174.84
          141.19
          124.75
          164.68
          146.77
          138.31
          142.77
          139.06
          114.59
          125.21
          125.36
          125.09
          121.22
        ];

errY = [    2.49
            2.40
            2.65
            1.89
            1.67
            1.21
            0.77
            0.72
            0.38
            1.24
            1.22
            0.87
            1.23
            1.18
            1.11
            1.00
            0.90
            0.82
            0.71
            0.59 
       ];

xrange = 1:20;
xlims = [1 8];
ylims = [0 400];

xlab = 'matrix size';
ylab = 'Qishr overhead / %';

hfig = figure;
set(hfig, 'Position', [0 0 1024 576]);
handle = plot(xrange, Y, '-s', 'LineWidth',2);
hold on
errorbar(xrange, Y, errY);
xlabel(xlab);
ylabel(ylab);
grid on;
ylim(ylims);

%% HISTOGRAMS

Y1 = [ 750330
750650
750710
752400
753650
754970
755010
755240
755780
755910
756010
756200
756540
756680
756830
756950
756990
757080
757150
757150
757290
757340
757570
757930
758010
758140
758160
758180
758290
758390
758410
759050
759120
759190
759280
759430
759560
759600
759650
759660
759680
759810
759910
760030
760100
760840
761030
761200
761280
761290
761340
761430
762100
762130
762180
762720
764680
765210
765350
767990
769170
772290
777110
779310
786900
869050
890350
897750
909160
912780
913290
1058660
1192770
1532300
1624930
1692030
1699780
1734020
1772580
1773320
1862580
1868140
1921160
1927340
1990060
2024190
2046900
2052250
2445230
2573340
2651960
2672610
2692410
2752730
2776930
2789910
2813820
2814090
3803590
25078760 ] .* 5;

Y2 = [ 1845020
1845230
1845270
1845690
1846350
1846460
1846510
1847210
1848020
1848280
1848330
1848610
1849090
1849180
1849200
1849260
1849340
1850190
1850850
1851490
1851950
1852860
1853270
1853810
1854670
1855890
1855940
1855980
1856520
1857480
1857560
1863160
1864800
1877090
1958520
1982520
1998410
1999190
2005860
2009840
2011410
2018200
2021480
2022420
2639920
2760640
2763910
2921600
2934390
2952240
2957840
2962640
2972680
2984890
3041610
3055550
3066040
3072970
3073960
3083220
3086930
3102500
3104190
3110560
3114070
3115260
3126570
3130090
3141130
3149590
3152030
3172770
3174120
3178070
3559170
3693780
3722520
3773870
3789650
3806820
3826810
3835600
3847560
3852200
3853050
3853980
3854830
3870600
3890010
3915410
3918570
3940360
3984370
3985890
4003410
4152080
25210170
27783560
28144870
31826420 ];

Y3 = [   3991270
 3991609
 3992160
 3992500
 4003780
 4012861
 4014170
 4032751
 4043540
 4048730
 4050371
 4059890
 4065590
 4072040
 4073620
 4080979
 4083841
 4094620
 4099030
 4113149
 4114030
 4136640
 4139890
 4140170
 4140730
 4157980
 4158740
 4186660
 4403600
 4431699
 4456190
 4484541
 4575760
 4592291
 4598650
 4606940
 4640141
 4648891
 4691510
 4693380
 4696520
 4702130
 4702751
 4710220
 4717370
 4719220
 4720401
 4726929
 4733970
 4734090
 4738980
 4740870
 4742120
 4748340
 4750450
 4759331
 4763190
 4776500
 4784849
 4787771
 4790350
 4790850
 4794810
 4796329
 4797590
 4802370
 4802420
 4815870
 4825781
 4833320
 4835089
 4841620
 4849170
 4854480
 4866200
 4877061
 4879780
 4880911
 4916050
 4918491
 4928920
 4930199
 4934270
 4938150
 4943440
 4954220
 4963130
 4974580
 5003240
 5044230
 5050031
 5059080
 5263071
 5390760
 6914990
 27244830
 27435911
 29131990
 30315340
 33240094 ];

Y4 = [ 204150
207840
208170
208220
209330
210170
211110
212660
213080
213090
213960
214380
214430
214469
214760
215310
216140
217060
218100
218831
219130
219620
219670
220360
220840
220920
222669
223040
224101
225110
225130
225680
225760
225980
226160
226831
228190
229780
230040
230420
230440
230910
231090
231140
231700
231710
232140
233341
233370
234080
234200
234660
235040
235630
235850
236060
236350
236680
236710
236860
237149
237600
237970
238010
239110
239320
239830
241190
241390
242290
242300
242640
243310
243901
244020
244100
244210
244590
245749
247710
248570
250350
250390
251231
251520
269310
272260
276260
338901
360230
378530
502780
1282710
1352840
1355930
1873720
1974680
2027490
2069270
2280170 ] .* 10;

figure;
hist(Y1);
colormap('summer');

figure;
hist(Y2);
colormap('summer');

figure;
hist(Y3);
colormap('summer');

figure;
hist(Y4);
colormap('summer');